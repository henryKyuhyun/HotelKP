{"ast":null,"code":"import { createSlice, createAsyncThunk } from \"@reduxjs/toolkit\";\nimport axios from 'axios';\nconst initialState = {\n  hotelPayment: {},\n  adminPayment: [],\n  userPayment: []\n};\nfunction getToken() {\n  return sessionStorage.getItem(\"accessToken\");\n}\nexport const postPayment = createAsyncThunk(\"payments/postPayment \", async paymentData => {\n  try {\n    const response = await axios.post(\"/api/hotelPayment\", paymentData, {\n      headers: {\n        Authorization: `Bearer ${getToken()}`\n      }\n    });\n    console.log(response.data);\n    return response.data;\n  } catch (error) {\n    console.log(error);\n  }\n});\nexport const fetchAdminPayment = createAsyncThunk(\"payments/fetchAdminPayment\", async userId => {\n  try {\n    const response = await axios.get(`/api/adminPayment/${userId}`, {\n      headers: {\n        Authorization: `Bearer ${getToken()}`\n      }\n    });\n    console.log(response.data);\n    if (response.data) {\n      console.log(response.data);\n      return response.data.result;\n    } else {\n      throw new Error('No data');\n    }\n  } catch (error) {\n    console.log(error);\n  }\n});\nexport const fetchUserPayment = createAsyncThunk(\"payments/fetchUserPayment\", async userId => {\n  try {\n    const response = await axios.get(`/api/userPayment/${userId}`, {\n      headers: {\n        Authorization: `Bearer ${getToken()}`\n      }\n    });\n    console.log(response);\n    return response.data.result;\n    // return response.data;\n  } catch (error) {\n    console.log(error);\n  }\n});\nexport const hotelPayments = createAsyncThunk(\"payments/hotelPayments\", async payment_id => {\n  try {\n    const response = await axios.patch(`/api/hotelPayments/${payment_id}`, {\n      status: '예약 확정'\n    }, {\n      headers: {\n        Authorization: `Bearer ${getToken()}`\n      }\n    });\n    console.log(response.data);\n    return {\n      payment_id,\n      status: response.data.status\n    };\n  } catch (error) {\n    console.log(error);\n  }\n});\nconst paymentSlice = createSlice({\n  name: 'payment',\n  initialState: initialState,\n  reducers: {},\n  extraReducers: builder => {\n    builder.addCase(postPayment.fulfilled, (state, action) => {\n      state.status = 'succeeded';\n      state.hotelPayment = action.payload;\n    }).addCase(fetchAdminPayment.fulfilled, (state, action) => {\n      state.adminPayment = action.payload;\n    }).addCase(fetchUserPayment.fulfilled, (state, action) => {\n      state.userPayment = action.payload;\n    }).addCase(hotelPayments.fulfilled, (state, action) => {\n      state.adminPayment = state.adminPayment.map(payment => payment.payment_id === action.payload.payment_id ? {\n        ...payment,\n        status: action.payload.status\n      } : payment);\n      state.userPayment = state.userPayment.map(payment => payment.payment_id === action.payload.payment_id ? {\n        ...payment,\n        status: action.payload.status\n      } : payment);\n    });\n  }\n});\nexport default paymentSlice.reducer;","map":{"version":3,"names":["createSlice","createAsyncThunk","axios","initialState","hotelPayment","adminPayment","userPayment","getToken","sessionStorage","getItem","postPayment","paymentData","response","post","headers","Authorization","console","log","data","error","fetchAdminPayment","userId","get","result","Error","fetchUserPayment","hotelPayments","payment_id","patch","status","paymentSlice","name","reducers","extraReducers","builder","addCase","fulfilled","state","action","payload","map","payment","reducer"],"sources":["/Users/kyuhyunpark/Desktop/HotelByKaaPaaa/HotelKP/client/src/redux/slice/paymentSlice.js"],"sourcesContent":["import { createSlice, createAsyncThunk} from \"@reduxjs/toolkit\";\nimport axios from 'axios';\n\nconst initialState = {\n    hotelPayment: {},\n    adminPayment: [],\n    userPayment: [],\n};\n\nfunction getToken() {\n    return sessionStorage.getItem(\"accessToken\");\n}\n\nexport const postPayment  = createAsyncThunk(\n    \"payments/postPayment \",\n    async (paymentData) => {\n        try{\n            const response = await axios.post(\"/api/hotelPayment\", paymentData,\n            {\n             headers: { Authorization: `Bearer ${getToken()}` },\n            });\n             console.log(response.data);\n             return response.data;\n          } catch (error) {\n            console.log(error);\n        }}\n)\n\nexport const fetchAdminPayment = createAsyncThunk(\n    \"payments/fetchAdminPayment\",\n    async (userId) => {\n        try{\n            const response = await axios.get(`/api/adminPayment/${userId}`, {\n                headers: { Authorization: `Bearer ${getToken()}` },\n            });\n            console.log(response.data);\n            if (response.data) {\n               console.log(response.data);\n               return response.data.result;\n            } else {\n                throw new Error('No data');\n            }\n        } catch (error) {\n            console.log(error);\n        }}\n)\n\nexport const fetchUserPayment = createAsyncThunk(\n    \"payments/fetchUserPayment\",\n    async (userId) => {\n        try{\n            const response = await axios.get(`/api/userPayment/${userId}`, {\n                headers: { Authorization: `Bearer ${getToken()}` },\n            });\n            console.log(response);\n            return response.data.result;\n            // return response.data;\n        } catch (error) {\n            console.log(error);\n        }\n    }\n)\n\nexport const hotelPayments = createAsyncThunk(\n    \"payments/hotelPayments\",\n    async (payment_id) => {\n        try{\n            const response = await axios.patch(`/api/hotelPayments/${payment_id}`,  \n            {\n                status:'예약 확정',\n            }, {\n                headers:{Authorization:`Bearer ${getToken()}`},\n            });\n            console.log(response.data);\n            return { payment_id, status: response.data.status }; \n        } catch (error) {\n            console.log(error);\n        }\n    }\n);\n\n\nconst paymentSlice = createSlice({\n    name:'payment',\n    initialState:initialState,\n    reducers:{},\n    extraReducers: (builder) => {\n        builder\n        .addCase(postPayment.fulfilled, (state, action) => {\n            state.status = 'succeeded';\n            state.hotelPayment = action.payload;\n        })\n        .addCase(fetchAdminPayment.fulfilled, (state, action) => {\n            state.adminPayment = action.payload;\n        })\n        .addCase(fetchUserPayment.fulfilled, (state, action) => {\n            state.userPayment = action.payload;\n        })\n        .addCase(hotelPayments.fulfilled, (state, action) => {\n            state.adminPayment = state.adminPayment.map(payment =>\n                payment.payment_id === action.payload.payment_id ? { ...payment, status: action.payload.status } : payment\n            );\n            state.userPayment = state.userPayment.map(payment =>\n                payment.payment_id === action.payload.payment_id ? { ...payment, status: action.payload.status } : payment\n            );\n        });\n    \n    }\n});\n\nexport default paymentSlice.reducer;"],"mappings":"AAAA,SAASA,WAAW,EAAEC,gBAAgB,QAAO,kBAAkB;AAC/D,OAAOC,KAAK,MAAM,OAAO;AAEzB,MAAMC,YAAY,GAAG;EACjBC,YAAY,EAAE,CAAC,CAAC;EAChBC,YAAY,EAAE,EAAE;EAChBC,WAAW,EAAE;AACjB,CAAC;AAED,SAASC,QAAQA,CAAA,EAAG;EAChB,OAAOC,cAAc,CAACC,OAAO,CAAC,aAAa,CAAC;AAChD;AAEA,OAAO,MAAMC,WAAW,GAAIT,gBAAgB,CACxC,uBAAuB,EACvB,MAAOU,WAAW,IAAK;EACnB,IAAG;IACC,MAAMC,QAAQ,GAAG,MAAMV,KAAK,CAACW,IAAI,CAAC,mBAAmB,EAAEF,WAAW,EAClE;MACCG,OAAO,EAAE;QAAEC,aAAa,EAAG,UAASR,QAAQ,CAAC,CAAE;MAAE;IAClD,CAAC,CAAC;IACDS,OAAO,CAACC,GAAG,CAACL,QAAQ,CAACM,IAAI,CAAC;IAC1B,OAAON,QAAQ,CAACM,IAAI;EACvB,CAAC,CAAC,OAAOC,KAAK,EAAE;IACdH,OAAO,CAACC,GAAG,CAACE,KAAK,CAAC;EACtB;AAAC,CACT,CAAC;AAED,OAAO,MAAMC,iBAAiB,GAAGnB,gBAAgB,CAC7C,4BAA4B,EAC5B,MAAOoB,MAAM,IAAK;EACd,IAAG;IACC,MAAMT,QAAQ,GAAG,MAAMV,KAAK,CAACoB,GAAG,CAAE,qBAAoBD,MAAO,EAAC,EAAE;MAC5DP,OAAO,EAAE;QAAEC,aAAa,EAAG,UAASR,QAAQ,CAAC,CAAE;MAAE;IACrD,CAAC,CAAC;IACFS,OAAO,CAACC,GAAG,CAACL,QAAQ,CAACM,IAAI,CAAC;IAC1B,IAAIN,QAAQ,CAACM,IAAI,EAAE;MAChBF,OAAO,CAACC,GAAG,CAACL,QAAQ,CAACM,IAAI,CAAC;MAC1B,OAAON,QAAQ,CAACM,IAAI,CAACK,MAAM;IAC9B,CAAC,MAAM;MACH,MAAM,IAAIC,KAAK,CAAC,SAAS,CAAC;IAC9B;EACJ,CAAC,CAAC,OAAOL,KAAK,EAAE;IACZH,OAAO,CAACC,GAAG,CAACE,KAAK,CAAC;EACtB;AAAC,CACT,CAAC;AAED,OAAO,MAAMM,gBAAgB,GAAGxB,gBAAgB,CAC5C,2BAA2B,EAC3B,MAAOoB,MAAM,IAAK;EACd,IAAG;IACC,MAAMT,QAAQ,GAAG,MAAMV,KAAK,CAACoB,GAAG,CAAE,oBAAmBD,MAAO,EAAC,EAAE;MAC3DP,OAAO,EAAE;QAAEC,aAAa,EAAG,UAASR,QAAQ,CAAC,CAAE;MAAE;IACrD,CAAC,CAAC;IACFS,OAAO,CAACC,GAAG,CAACL,QAAQ,CAAC;IACrB,OAAOA,QAAQ,CAACM,IAAI,CAACK,MAAM;IAC3B;EACJ,CAAC,CAAC,OAAOJ,KAAK,EAAE;IACZH,OAAO,CAACC,GAAG,CAACE,KAAK,CAAC;EACtB;AACJ,CACJ,CAAC;AAED,OAAO,MAAMO,aAAa,GAAGzB,gBAAgB,CACzC,wBAAwB,EACxB,MAAO0B,UAAU,IAAK;EAClB,IAAG;IACC,MAAMf,QAAQ,GAAG,MAAMV,KAAK,CAAC0B,KAAK,CAAE,sBAAqBD,UAAW,EAAC,EACrE;MACIE,MAAM,EAAC;IACX,CAAC,EAAE;MACCf,OAAO,EAAC;QAACC,aAAa,EAAE,UAASR,QAAQ,CAAC,CAAE;MAAC;IACjD,CAAC,CAAC;IACFS,OAAO,CAACC,GAAG,CAACL,QAAQ,CAACM,IAAI,CAAC;IAC1B,OAAO;MAAES,UAAU;MAAEE,MAAM,EAAEjB,QAAQ,CAACM,IAAI,CAACW;IAAO,CAAC;EACvD,CAAC,CAAC,OAAOV,KAAK,EAAE;IACZH,OAAO,CAACC,GAAG,CAACE,KAAK,CAAC;EACtB;AACJ,CACJ,CAAC;AAGD,MAAMW,YAAY,GAAG9B,WAAW,CAAC;EAC7B+B,IAAI,EAAC,SAAS;EACd5B,YAAY,EAACA,YAAY;EACzB6B,QAAQ,EAAC,CAAC,CAAC;EACXC,aAAa,EAAGC,OAAO,IAAK;IACxBA,OAAO,CACNC,OAAO,CAACzB,WAAW,CAAC0B,SAAS,EAAE,CAACC,KAAK,EAAEC,MAAM,KAAK;MAC/CD,KAAK,CAACR,MAAM,GAAG,WAAW;MAC1BQ,KAAK,CAACjC,YAAY,GAAGkC,MAAM,CAACC,OAAO;IACvC,CAAC,CAAC,CACDJ,OAAO,CAACf,iBAAiB,CAACgB,SAAS,EAAE,CAACC,KAAK,EAAEC,MAAM,KAAK;MACrDD,KAAK,CAAChC,YAAY,GAAGiC,MAAM,CAACC,OAAO;IACvC,CAAC,CAAC,CACDJ,OAAO,CAACV,gBAAgB,CAACW,SAAS,EAAE,CAACC,KAAK,EAAEC,MAAM,KAAK;MACpDD,KAAK,CAAC/B,WAAW,GAAGgC,MAAM,CAACC,OAAO;IACtC,CAAC,CAAC,CACDJ,OAAO,CAACT,aAAa,CAACU,SAAS,EAAE,CAACC,KAAK,EAAEC,MAAM,KAAK;MACjDD,KAAK,CAAChC,YAAY,GAAGgC,KAAK,CAAChC,YAAY,CAACmC,GAAG,CAACC,OAAO,IAC/CA,OAAO,CAACd,UAAU,KAAKW,MAAM,CAACC,OAAO,CAACZ,UAAU,GAAG;QAAE,GAAGc,OAAO;QAAEZ,MAAM,EAAES,MAAM,CAACC,OAAO,CAACV;MAAO,CAAC,GAAGY,OACvG,CAAC;MACDJ,KAAK,CAAC/B,WAAW,GAAG+B,KAAK,CAAC/B,WAAW,CAACkC,GAAG,CAACC,OAAO,IAC7CA,OAAO,CAACd,UAAU,KAAKW,MAAM,CAACC,OAAO,CAACZ,UAAU,GAAG;QAAE,GAAGc,OAAO;QAAEZ,MAAM,EAAES,MAAM,CAACC,OAAO,CAACV;MAAO,CAAC,GAAGY,OACvG,CAAC;IACL,CAAC,CAAC;EAEN;AACJ,CAAC,CAAC;AAEF,eAAeX,YAAY,CAACY,OAAO"},"metadata":{},"sourceType":"module","externalDependencies":[]}