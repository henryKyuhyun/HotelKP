{"ast":null,"code":"var _jsxFileName = \"/Users/kyuhyunpark/Desktop/HotelByKaaPaaa/HotelKP/client/src/components/hotel/comment/CommentContainer.jsx\",\n  _s = $RefreshSig$();\n// import React, { useEffect, useState } from 'react';\n// import { useDispatch, useSelector } from \"react-redux\";\n// import { fetchComments } from '../../../redux/slice/commentSlice';\n// import CommentCard from './CommentCard';\n// import CommentForm from './CommentForm';\n// import {\n//     CommentLayout,\n//     CommentHeader,\n//     CommentTitle,\n//     FormAndLinkContainer,\n//     LinkButton,\n// }from './CommentStyle';\n// import Star from '../../shared/star/Star';\n// import {fetchUserPayment} from '../../../redux/slice/paymentSlice';\n\n// export default function CommentContainer({hotel_id}) {\n//     // const comments = useSelector((state) => state.comment || []);\n//     const dispatch = useDispatch();\n//     const loggedInUser = JSON.parse(localStorage.getItem(\"loggedInUser\"));\n//     const userId = loggedInUser.id;\n\n//     const allComments = useSelector((state) => state.comment.comments || {});\n//     const comments = allComments[hotel_id] || [];\n//     const userPayment = useSelector((state) => state.payment.userPayment || []);\n//     const paymentHotel = userPayment.find(pay => {\n//         return pay.hotel_id === Number(hotel_id);\n//     });\n//     let checkOutTime;\n//     if (paymentHotel) {\n//         checkOutTime = new Date(paymentHotel.check_out);\n//     }\n//     const currentTime = new Date();\n\n//     useEffect(() =>{\n//         dispatch(fetchComments(hotel_id));\n//         dispatch(fetchUserPayment(userId));\n//     },[hotel_id]);\n\n//     const handleNewComment = () => {\n//         dispatch(fetchComments(hotel_id));\n//     };\n\n//     return (\n//         <CommentLayout>\n//             {comments.length === 0 ?\n//                 <>\n//                 <h1>후기가 아직 없습니다</h1>\n//                 {paymentHotel && checkOutTime < currentTime ? <CommentForm hotel_id={hotel_id} onSubmitSuccess={handleNewComment} /> : null}\n//                 </>\n\n//             :\n//             <>\n//                 <CommentHeader>\n//                     <CommentTitle>후기 {comments.length}개</CommentTitle>\n//                     {comments.length > 5 &&\n//                         <LinkButton to={{pathname: `/comments/${hotel_id}`,state: { hotel_id }}}>후기 전체보기</LinkButton>\n//                     }\n//                 </CommentHeader>\n//                 <ul>\n//                     {comments.slice(0, 5).map((comment) => (\n//                         <CommentCard key={comment.id} comment={comment}/>\n//                     ))\n//                     }\n//                 </ul>\n//             </>\n//             }\n//             <FormAndLinkContainer>\n//                 {paymentHotel && checkOutTime < currentTime ? <CommentForm hotel_id={hotel_id} onSubmitSuccess={handleNewComment} /> : null}\n//             </FormAndLinkContainer>\n\n//         </CommentLayout>\n\n//     );\n// }\n\nimport React, { useEffect, useState } from 'react';\nimport { useDispatch, useSelector } from \"react-redux\";\nimport { fetchComments } from '../../../redux/slice/commentSlice';\nimport CommentCard from './CommentCard';\nimport CommentForm from './CommentForm';\nimport { CommentLayout, CommentHeader, CommentTitle, FormAndLinkContainer, LinkButton } from './CommentStyle';\nimport Star from '../../shared/star/Star';\nimport { fetchUserPayment } from '../../../redux/slice/paymentSlice';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nexport default function CommentContainer({\n  hotel_id\n}) {\n  _s();\n  const dispatch = useDispatch();\n  const userId = loggedInUser.id;\n  const isLoggedIn = useSelector(state => {\n    var _state$auth;\n    return (_state$auth = state.auth) === null || _state$auth === void 0 ? void 0 : _state$auth.isLoggedIn;\n  });\n  const [loggedInUser, setLoggedInUser] = useState(null); // loggedInUser 상태 추가\n\n  const allComments = useSelector(state => state.comment.comments || {});\n  const comments = allComments[hotel_id] || [];\n  const userPayment = useSelector(state => state.payment.userPayment || []);\n  const paymentHotel = userPayment.find(pay => {\n    return pay.hotel_id === Number(hotel_id);\n  });\n  let checkOutTime;\n  if (paymentHotel) {\n    checkOutTime = new Date(paymentHotel.check_out);\n  }\n  const currentTime = new Date();\n  useEffect(() => {\n    dispatch(fetchComments(hotel_id));\n    dispatch(fetchUserPayment(userId));\n  }, [hotel_id]);\n  useEffect(() => {\n    if (isLoggedIn) {\n      const storedUser = localStorage.getItem('loggedInUser');\n      setLoggedInUser(JSON.parse(storedUser));\n    } else {\n      setLoggedInUser(null);\n    }\n  }, [isLoggedIn]);\n  const handleNewComment = () => {\n    dispatch(fetchComments(hotel_id));\n  };\n  return /*#__PURE__*/_jsxDEV(CommentLayout, {\n    children: [comments.length === 0 ? /*#__PURE__*/_jsxDEV(_Fragment, {\n      children: [/*#__PURE__*/_jsxDEV(\"h1\", {\n        children: \"\\uD6C4\\uAE30\\uAC00 \\uC544\\uC9C1 \\uC5C6\\uC2B5\\uB2C8\\uB2E4\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 136,\n        columnNumber: 17\n      }, this), paymentHotel && checkOutTime < currentTime ? /*#__PURE__*/_jsxDEV(CommentForm, {\n        hotel_id: hotel_id,\n        onSubmitSuccess: handleNewComment\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 137,\n        columnNumber: 63\n      }, this) : null]\n    }, void 0, true) : /*#__PURE__*/_jsxDEV(_Fragment, {\n      children: [/*#__PURE__*/_jsxDEV(CommentHeader, {\n        children: [/*#__PURE__*/_jsxDEV(CommentTitle, {\n          children: [\"\\uD6C4\\uAE30 \", comments.length, \"\\uAC1C\"]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 143,\n          columnNumber: 21\n        }, this), comments.length > 5 && /*#__PURE__*/_jsxDEV(LinkButton, {\n          to: {\n            pathname: `/comments/${hotel_id}`,\n            state: {\n              hotel_id\n            }\n          },\n          children: \"\\uD6C4\\uAE30 \\uC804\\uCCB4\\uBCF4\\uAE30\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 145,\n          columnNumber: 25\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 142,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"ul\", {\n        children: comments.slice(0, 5).map(comment => /*#__PURE__*/_jsxDEV(CommentCard, {\n          comment: comment\n        }, comment.id, false, {\n          fileName: _jsxFileName,\n          lineNumber: 150,\n          columnNumber: 25\n        }, this))\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 148,\n        columnNumber: 17\n      }, this)]\n    }, void 0, true), /*#__PURE__*/_jsxDEV(FormAndLinkContainer, {\n      children: paymentHotel && checkOutTime < currentTime ? /*#__PURE__*/_jsxDEV(CommentForm, {\n        hotel_id: hotel_id,\n        onSubmitSuccess: handleNewComment\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 157,\n        columnNumber: 63\n      }, this) : null\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 156,\n      columnNumber: 13\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 133,\n    columnNumber: 9\n  }, this);\n}\n_s(CommentContainer, \"HJTdiFzzL7c50TEIkBgZlEy9K/4=\", false, function () {\n  return [useDispatch, useSelector, useSelector, useSelector];\n});\n_c = CommentContainer;\nvar _c;\n$RefreshReg$(_c, \"CommentContainer\");","map":{"version":3,"names":["React","useEffect","useState","useDispatch","useSelector","fetchComments","CommentCard","CommentForm","CommentLayout","CommentHeader","CommentTitle","FormAndLinkContainer","LinkButton","Star","fetchUserPayment","jsxDEV","_jsxDEV","Fragment","_Fragment","CommentContainer","hotel_id","_s","dispatch","userId","loggedInUser","id","isLoggedIn","state","_state$auth","auth","setLoggedInUser","allComments","comment","comments","userPayment","payment","paymentHotel","find","pay","Number","checkOutTime","Date","check_out","currentTime","storedUser","localStorage","getItem","JSON","parse","handleNewComment","children","length","fileName","_jsxFileName","lineNumber","columnNumber","onSubmitSuccess","to","pathname","slice","map","_c","$RefreshReg$"],"sources":["/Users/kyuhyunpark/Desktop/HotelByKaaPaaa/HotelKP/client/src/components/hotel/comment/CommentContainer.jsx"],"sourcesContent":["// import React, { useEffect, useState } from 'react';\n// import { useDispatch, useSelector } from \"react-redux\";\n// import { fetchComments } from '../../../redux/slice/commentSlice';\n// import CommentCard from './CommentCard';\n// import CommentForm from './CommentForm';\n// import {\n//     CommentLayout,\n//     CommentHeader,\n//     CommentTitle,\n//     FormAndLinkContainer,\n//     LinkButton,\n// }from './CommentStyle';\n// import Star from '../../shared/star/Star';\n// import {fetchUserPayment} from '../../../redux/slice/paymentSlice';\n\n\n// export default function CommentContainer({hotel_id}) {\n//     // const comments = useSelector((state) => state.comment || []);\n//     const dispatch = useDispatch();\n//     const loggedInUser = JSON.parse(localStorage.getItem(\"loggedInUser\"));\n//     const userId = loggedInUser.id;\n\n//     const allComments = useSelector((state) => state.comment.comments || {});\n//     const comments = allComments[hotel_id] || [];\n//     const userPayment = useSelector((state) => state.payment.userPayment || []);\n//     const paymentHotel = userPayment.find(pay => {\n//         return pay.hotel_id === Number(hotel_id);\n//     });\n//     let checkOutTime;\n//     if (paymentHotel) {\n//         checkOutTime = new Date(paymentHotel.check_out);\n//     }\n//     const currentTime = new Date();\n\n//     useEffect(() =>{\n//         dispatch(fetchComments(hotel_id));\n//         dispatch(fetchUserPayment(userId));\n//     },[hotel_id]);\n\n//     const handleNewComment = () => {\n//         dispatch(fetchComments(hotel_id));\n//     };\n    \n\n//     return (\n//         <CommentLayout>\n//             {comments.length === 0 ?\n//                 <>\n//                 <h1>후기가 아직 없습니다</h1>\n//                 {paymentHotel && checkOutTime < currentTime ? <CommentForm hotel_id={hotel_id} onSubmitSuccess={handleNewComment} /> : null}\n//                 </>\n                \n//             :\n//             <>\n//                 <CommentHeader>\n//                     <CommentTitle>후기 {comments.length}개</CommentTitle>\n//                     {comments.length > 5 &&\n//                         <LinkButton to={{pathname: `/comments/${hotel_id}`,state: { hotel_id }}}>후기 전체보기</LinkButton>\n//                     }\n//                 </CommentHeader>\n//                 <ul>\n//                     {comments.slice(0, 5).map((comment) => (\n//                         <CommentCard key={comment.id} comment={comment}/>\n//                     ))\n//                     }\n//                 </ul>\n//             </>\n//             }\n//             <FormAndLinkContainer>\n//                 {paymentHotel && checkOutTime < currentTime ? <CommentForm hotel_id={hotel_id} onSubmitSuccess={handleNewComment} /> : null}\n//             </FormAndLinkContainer>\n\n//         </CommentLayout>\n        \n//     );\n// }\n\nimport React, { useEffect, useState } from 'react';\nimport { useDispatch, useSelector } from \"react-redux\";\nimport { fetchComments } from '../../../redux/slice/commentSlice';\nimport CommentCard from './CommentCard';\nimport CommentForm from './CommentForm';\nimport {\n    CommentLayout,\n    CommentHeader,\n    CommentTitle,\n    FormAndLinkContainer,\n    LinkButton,\n}from './CommentStyle';\nimport Star from '../../shared/star/Star';\nimport {fetchUserPayment} from '../../../redux/slice/paymentSlice';\n\n\nexport default function CommentContainer({hotel_id}) {\n    const dispatch = useDispatch();\n    const userId = loggedInUser.id;\n    const isLoggedIn = useSelector((state) => state.auth?.isLoggedIn);\n    const [loggedInUser, setLoggedInUser] = useState(null); // loggedInUser 상태 추가\n\n    const allComments = useSelector((state) => state.comment.comments || {});\n    const comments = allComments[hotel_id] || [];\n    const userPayment = useSelector((state) => state.payment.userPayment || []);\n    const paymentHotel = userPayment.find(pay => {\n        return pay.hotel_id === Number(hotel_id);\n    });\n    let checkOutTime;\n    if (paymentHotel) {\n        checkOutTime = new Date(paymentHotel.check_out);\n    }\n    const currentTime = new Date();\n\n    useEffect(() =>{\n        dispatch(fetchComments(hotel_id));\n        dispatch(fetchUserPayment(userId));\n    },[hotel_id]);\n\n    useEffect(() => {\n        if (isLoggedIn) {\n          const storedUser = localStorage.getItem('loggedInUser');\n          setLoggedInUser(JSON.parse(storedUser));\n          \n        } else {\n          setLoggedInUser(null);\n        }\n      }, [isLoggedIn]);\n\n    const handleNewComment = () => {\n        dispatch(fetchComments(hotel_id));\n    };\n    \n\n    return (\n        <CommentLayout>\n            {comments.length === 0 ?\n                <>\n                <h1>후기가 아직 없습니다</h1>\n                {paymentHotel && checkOutTime < currentTime ? <CommentForm hotel_id={hotel_id} onSubmitSuccess={handleNewComment} /> : null}\n                </>\n                \n            :\n            <>\n                <CommentHeader>\n                    <CommentTitle>후기 {comments.length}개</CommentTitle>\n                    {comments.length > 5 &&\n                        <LinkButton to={{pathname: `/comments/${hotel_id}`,state: { hotel_id }}}>후기 전체보기</LinkButton>\n                    }\n                </CommentHeader>\n                <ul>\n                    {comments.slice(0, 5).map((comment) => (\n                        <CommentCard key={comment.id} comment={comment}/>\n                    ))\n                    }\n                </ul>\n            </>\n            }\n            <FormAndLinkContainer>\n                {paymentHotel && checkOutTime < currentTime ? <CommentForm hotel_id={hotel_id} onSubmitSuccess={handleNewComment} /> : null}\n            </FormAndLinkContainer>\n\n        </CommentLayout>\n        \n    );\n}"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}