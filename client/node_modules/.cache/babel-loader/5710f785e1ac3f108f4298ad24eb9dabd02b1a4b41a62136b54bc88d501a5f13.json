{"ast":null,"code":"var _jsxFileName = \"/Users/kyuhyunpark/Desktop/HotelByKaaPaaa/HotelKP/client/src/pages/LoginPage.jsx\",\n  _s = $RefreshSig$();\n// client/src/pages/LoginPage.jsx\n\nimport React, { useState, useEffect } from 'react';\nimport axios from 'axios';\nimport jwt_decode from 'jwt-decode';\nimport { useNavigate } from \"react-router-dom\";\nimport { CustomContainer, FormControlContainer, FormInput, FormLabel, FormTitle, LoginFormContainer, SubmitButton } from '../components/pagestyles/LoginPageStyle';\nimport { useSelector, useDispatch } from 'react-redux';\nimport { login } from '../redux/slice/authSlice';\nimport { fetchUserLikes } from '../redux/slice/likeSlice';\nimport { setupNotification } from '../services/notifications';\nimport { AccommdationStyle, HeaderMain, LinkTitle } from '../components/shared/header/HeaderStyle';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nexport default function LoginPage() {\n  _s();\n  const [id, setId] = useState('');\n  const [password, setPassword] = useState('');\n  const navigate = useNavigate();\n  const isLoggedIn = useSelector(state => {\n    var _state$auth;\n    return (_state$auth = state.auth) === null || _state$auth === void 0 ? void 0 : _state$auth.isLoggedIn;\n  });\n  const dispatch = useDispatch();\n  useEffect(() => {\n    if (isLoggedIn) {\n      navigate(\"/\");\n    }\n  }, [isLoggedIn, navigate]);\n  const handleSubmit = async e => {\n    e.preventDefault();\n    try {\n      const res = await axios.post('http://localhost:4000/api/login', {\n        id,\n        password\n      });\n      if (res.status === 200) {\n        sessionStorage.setItem('accessToken', res.data.accessToken);\n        const decodedToken = jwt_decode(res.data.accessToken);\n        const userRole = res.data.userRole; // 응답으로부터 userRole 가져오기\n\n        const loggedInUserData = {\n          ...decodedToken,\n          userRole: userRole\n        };\n        localStorage.setItem(\"loggedInUser\", JSON.stringify(loggedInUserData));\n        dispatch(login({\n          userId: decodedToken.id,\n          userRole: userRole,\n          token: res.data.accessToken\n        })); // Save userId and userRole to the redux store => 이렇게 해야 useSelector(state => state.auth.userId)를 통해 로그인한 사용자ID가져올수 있을듯\n        dispatch(fetchUserLikes(decodedToken.id));\n\n        //알림 설정\n        await setupNotification(loggedInUserData);\n      }\n    } catch (error) {\n      if (error.response.status === 401) {\n        alert(error.response.data.message);\n      }\n    }\n  };\n  return /*#__PURE__*/_jsxDEV(CustomContainer, {\n    children: /*#__PURE__*/_jsxDEV(LoginFormContainer, {\n      onSubmit: handleSubmit,\n      children: [/*#__PURE__*/_jsxDEV(LinkTitle, {\n        to: \"/\",\n        children: [/*#__PURE__*/_jsxDEV(HeaderMain, {\n          children: \"\\uB204\\uAD6C\\uC5C5\\uC18C\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 71,\n          columnNumber: 9\n        }, this), /*#__PURE__*/_jsxDEV(AccommdationStyle, {\n          children: \"ACCOMMODATION\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 72,\n          columnNumber: 9\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 70,\n        columnNumber: 7\n      }, this), /*#__PURE__*/_jsxDEV(FormTitle, {\n        children: \"\\uB85C\\uADF8\\uC778\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 74,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(FormControlContainer, {\n        children: [/*#__PURE__*/_jsxDEV(FormLabel, {\n          htmlFor: \"userId\",\n          children: \"\\uC544\\uC774\\uB514:\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 76,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(FormInput, {\n          id: \"userId\",\n          type: \"text\",\n          value: id,\n          onChange: e => setId(e.target.value),\n          placeholder: \"ID\\uB97C \\uC785\\uB825\\uD574\\uC8FC\\uC138\\uC694\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 77,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 75,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(FormControlContainer, {\n        children: [/*#__PURE__*/_jsxDEV(FormLabel, {\n          htmlFor: \"password\",\n          children: \"\\uBE44\\uBC00\\uBC88\\uD638:\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 80,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(FormInput, {\n          id: \"password\",\n          type: \"password\",\n          value: password,\n          onChange: e => setPassword(e.target.value),\n          placeholder: \"password\\uB97C \\uC785\\uB825\\uD574\\uC8FC\\uC138\\uC694\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 81,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 79,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(SubmitButton, {\n        type: \"submit\",\n        children: \"\\uB85C\\uADF8\\uC778\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 89,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 69,\n      columnNumber: 7\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 67,\n    columnNumber: 5\n  }, this);\n}\n_s(LoginPage, \"p96gMBGWhoWjCSMEe5gQf4NgUVE=\", false, function () {\n  return [useNavigate, useSelector, useDispatch];\n});\n_c = LoginPage;\nvar _c;\n$RefreshReg$(_c, \"LoginPage\");","map":{"version":3,"names":["React","useState","useEffect","axios","jwt_decode","useNavigate","CustomContainer","FormControlContainer","FormInput","FormLabel","FormTitle","LoginFormContainer","SubmitButton","useSelector","useDispatch","login","fetchUserLikes","setupNotification","AccommdationStyle","HeaderMain","LinkTitle","jsxDEV","_jsxDEV","LoginPage","_s","id","setId","password","setPassword","navigate","isLoggedIn","state","_state$auth","auth","dispatch","handleSubmit","e","preventDefault","res","post","status","sessionStorage","setItem","data","accessToken","decodedToken","userRole","loggedInUserData","localStorage","JSON","stringify","userId","token","error","response","alert","message","children","onSubmit","to","fileName","_jsxFileName","lineNumber","columnNumber","htmlFor","type","value","onChange","target","placeholder","_c","$RefreshReg$"],"sources":["/Users/kyuhyunpark/Desktop/HotelByKaaPaaa/HotelKP/client/src/pages/LoginPage.jsx"],"sourcesContent":["// client/src/pages/LoginPage.jsx\n\nimport React, { useState, useEffect } from 'react';\nimport axios from 'axios';\nimport jwt_decode from 'jwt-decode';\nimport { useNavigate } from \"react-router-dom\";\nimport { CustomContainer, FormControlContainer, FormInput, FormLabel, FormTitle, LoginFormContainer, SubmitButton } from '../components/pagestyles/LoginPageStyle';\nimport { useSelector, useDispatch } from 'react-redux';\nimport { login } from '../redux/slice/authSlice';\nimport { fetchUserLikes } from '../redux/slice/likeSlice';\nimport { setupNotification } from '../services/notifications';\nimport { AccommdationStyle, HeaderMain, LinkTitle } from '../components/shared/header/HeaderStyle';\n\nexport default function LoginPage() {\n  const [id, setId] = useState('');\n  const [password, setPassword] = useState('');\n\n  const navigate = useNavigate();\n  const isLoggedIn = useSelector((state) => state.auth?.isLoggedIn);\n  \n  const dispatch = useDispatch();\n  \n  useEffect(() => {\n    if (isLoggedIn) {\n        navigate(\"/\");\n    }\n  }, [isLoggedIn, navigate]);\n\n\n  const handleSubmit = async (e) => {\n    e.preventDefault();\n  \n    try {\n      const res = await axios.post('http://localhost:4000/api/login', {\n        id,\n        password,\n      });\n  \n      if (res.status === 200) {\n        sessionStorage.setItem('accessToken', res.data.accessToken);\n  \n        const decodedToken = jwt_decode(res.data.accessToken);\n        const userRole = res.data.userRole; // 응답으로부터 userRole 가져오기\n\n        const loggedInUserData = {\n          ...decodedToken,\n          userRole: userRole,\n        };\n        \n        localStorage.setItem(\"loggedInUser\", JSON.stringify(loggedInUserData)); \n\n        dispatch(login({ userId: decodedToken.id, userRole: userRole, token: res.data.accessToken })); // Save userId and userRole to the redux store => 이렇게 해야 useSelector(state => state.auth.userId)를 통해 로그인한 사용자ID가져올수 있을듯\n        dispatch(fetchUserLikes(decodedToken.id));\n\n         //알림 설정\n        await setupNotification(loggedInUserData);\n      }\n    } catch (error) {\n      if (error.response.status === 401) {\n        alert(error.response.data.message);\n      }\n    }\n  };\n\n  \n  return (\n    <CustomContainer>\n      \n      <LoginFormContainer onSubmit={handleSubmit}>\n      <LinkTitle to=\"/\">\n        <HeaderMain>누구업소</HeaderMain>\n        <AccommdationStyle>ACCOMMODATION</AccommdationStyle>\n      </LinkTitle>\n        <FormTitle>로그인</FormTitle>\n        <FormControlContainer>\n          <FormLabel htmlFor='userId'>아이디:</FormLabel>\n          <FormInput id='userId' type=\"text\" value={id} onChange={(e) => setId(e.target.value)} placeholder='ID를 입력해주세요'/>\n        </FormControlContainer>\n        <FormControlContainer>\n          <FormLabel htmlFor='password'>비밀번호:</FormLabel>\n          <FormInput\n            id='password'\n            type=\"password\"\n            value={password}\n            onChange={(e) => setPassword(e.target.value)}\n            placeholder='password를 입력해주세요'\n          />\n        </FormControlContainer>\n        <SubmitButton type=\"submit\">로그인</SubmitButton>\n      </LoginFormContainer>\n    </CustomContainer>\n  );\n}\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}